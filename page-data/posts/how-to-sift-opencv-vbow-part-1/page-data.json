{"componentChunkName":"component---src-pages-posts-markdown-remark-frontmatter-slug-tsx","path":"/posts/how-to-sift-opencv-vbow-part-1/","result":{"data":{"markdownRemark":{"html":"<h1>Image Classification in Python with Visual Bag of Words (VBoW)</h1>\n<p><a href=\"../how-to-sift-opencv-vbow-part-1\">Part 1</a></p>\n<p><a href=\"../how-to-sift-opencv-vbow-part-2\">Part 2</a></p>\n<h2>Part 1: Feature Generation with SIFT</h2>\n<h3>Why we need to generate features</h3>\n<p>Raw pixel data is hard to use for machine learning, and for comparing images in general.</p>\n<p>A digital image in its simplest form is just a matrix of pixel intensity values. Why not flatten this matrix to an array of pixel intensities and use that as your feature set for an image classifier? For simple, curated images like the 20x20 pixel <a href=\"http://yann.lecun.com/exdb/mnist/\">MNIST digit dataset</a>, the raw pixel method can lead to a successful machine learning model. Each image has already been centered in the frame, and all the images have the same aspect ratio and same number of pixels.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e7ef4968457f6749190fa6b47cf43d6d/a76f4/mnist-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAACSElEQVR42q2Uz0uyQRDHRfDQISgCoZAOoiRKSgehS4T+A14EPQgevHjQbkFgehQvoteE/oCSUBARD17snKCICCqVZKkpCP64aH5jFvZ5H/FHEe/AsPvsPvPZmd2ZkTQaDfR6PXQ6HXS73T8p2RLj5eUFkvf3d5DM53P8VbgtgQXg19cX21iltDedTjGbzQSA+H+ak5C3ko+Pj7UeciOxJ61WC4PBYMGGjz8CudDdRKNR2O12HB0dwev1YjgcCnY/Avm8VqshGAxCp9NBIpHg5OQEZ2dn2N7eRi6XW4piJZCPb29vOD09ZSBSo9GIZrOJVCrFvuPx+O+A/IIzmQz29/eh1+vhdrtRqVTYejgcZsCHh4ffAbmMRiM8Pj7i9fVVOIRGj8fDgPf3978H0k8cQuvZbBY3NzdMDQYDVCoVisUi26dU2pg24vxKJpOwWq3Y2trCzs4OZDIZ8+76+lqw2QjkUMqzq6sr7O7uwuVyIZ1OIxAIMKBUKoVCocDd3d3mtOGnUPk4HA7mid/vZ2ulUglarRZKpRKhUAhmsxkHBwe4uLhALBZDPp//V3ocSDKZTOB0OiGXy3F7e4tCoQCfz4fDw0PYbDY8PT0JESQSCZyfn+P4+Fh48Xa7vQikyyfP9vb2YDKZoFarWXiXl5dCZfBISPr9PqgXrLxDkmq1CovFAo1Gw8KKRCIol8tLTUB8b+JDVr4y5R9VxHg8XijFdc1jKQ/F7Uu8SXNKCdJ1bW1l+/rvDbZer+Pz85O9EC38RcmWGM/Pz/gGvG14aHD2QpcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"handwritten number 2\"\n        title=\"\"\n        src=\"/static/e7ef4968457f6749190fa6b47cf43d6d/a76f4/mnist-2.png\"\n        srcset=\"/static/e7ef4968457f6749190fa6b47cf43d6d/12f09/mnist-2.png 148w,\n/static/e7ef4968457f6749190fa6b47cf43d6d/e4a3f/mnist-2.png 295w,\n/static/e7ef4968457f6749190fa6b47cf43d6d/a76f4/mnist-2.png 586w\"\n        sizes=\"(max-width: 586px) 100vw, 586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>But what about images that are less simple and less curated?</p>\n<p>Imagine taking several pictures of an object with a handheld camera. Since it's the same camera, the photos will have the same resolution and aspect ratio, so the pixel matrices will be the same size &#x26; shape.</p>\n<p>Consider this stereo image (via <a href=\"http://www.waystation.net/\">http://www.waystation.net/</a>) of an octopus:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGF6LWE0Sv/xAAbEAACAgMBAAAAAAAAAAAAAAABAgADBBITEf/aAAgBAQABBQJql3NXNRio05p7opgRRP/EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAEDAQE/AYf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAgEBPwGn/8QAHRAAAQIHAAAAAAAAAAAAAAAAAAERAxATMTOBkf/aAAgBAQAGPwJEWJtjJwesWn//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhMUGBsf/aAAgBAQABPyFCZEyNIauTwDcC9CWWekXlmsQton//2gAMAwEAAgADAAAAEOwP/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAEDAQE/EITH/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAECAQE/EDK//8QAHRABAAIBBQEAAAAAAAAAAAAAAQARITFBUWGRcf/aAAgBAQABPxBD9HAdNYKjdwFcbwrgXUEz7BArZ0L5maQJ9BtAAaW6Qa9n/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"octopus stereo\"\n        title=\"\"\n        src=\"/static/a0a4eb6498665bc901fc54eb73a91b44/1c72d/StereoOctopus.jpg\"\n        srcset=\"/static/a0a4eb6498665bc901fc54eb73a91b44/a80bd/StereoOctopus.jpg 148w,\n/static/a0a4eb6498665bc901fc54eb73a91b44/1c91a/StereoOctopus.jpg 295w,\n/static/a0a4eb6498665bc901fc54eb73a91b44/1c72d/StereoOctopus.jpg 590w,\n/static/a0a4eb6498665bc901fc54eb73a91b44/8608d/StereoOctopus.jpg 638w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span> (PS: if you cross your eyes it will look 3D)</p>\n<p>Even though the two photos were taken simultaneously from locations a few inches apart, and they are very visually similar, the raw pixel locations do not match up at all. Every pixel location has been shifted and transformed in a complex way.</p>\n<h4>The problem of scale</h4>\n<p>Photographs of the same objects will also change scale depending on focal length, distance from object, et cetera. This is another reason that raw pixel values are typically not good features for images. You can see how zooming in on the octopus will totally throw off the pixel locations:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/66b00b07dbe6e8ea59bf2ed2a3091975/8608d/ZoomOctopus.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABTl+sqm4P/8QAGhAAAwEAAwAAAAAAAAAAAAAAAQIDABESE//aAAgBAQABBQIzHZozRFjAr5pmjyTHf//EABURAQEAAAAAAAAAAAAAAAAAAAAh/9oACAEDAQE/AYj/xAAVEQEBAAAAAAAAAAAAAAAAAAAAIf/aAAgBAgEBPwGq/8QAHBAAAgICAwAAAAAAAAAAAAAAAAECIRAREzEy/9oACAEBAAY/AlHko9tiblLZ1imf/8QAGxABAAMBAAMAAAAAAAAAAAAAAQARMUEhYYH/2gAIAQEAAT8hOt21DI6RJ8hMiPJcuV6hHWZK3h7n/9oADAMBAAIAAwAAABBs3//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EIQ//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERUf/aAAgBAgEBPxCS8P/EABoQAQADAQEBAAAAAAAAAAAAAAEAETEhUYH/2gAIAQEAAT8QRFFwa/YxxgAoN9zclsogHj5kGjocrlPsRHVBN4BtVFrZpup//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"octopus stereo\"\n        title=\"\"\n        src=\"/static/66b00b07dbe6e8ea59bf2ed2a3091975/1c72d/ZoomOctopus.jpg\"\n        srcset=\"/static/66b00b07dbe6e8ea59bf2ed2a3091975/a80bd/ZoomOctopus.jpg 148w,\n/static/66b00b07dbe6e8ea59bf2ed2a3091975/1c91a/ZoomOctopus.jpg 295w,\n/static/66b00b07dbe6e8ea59bf2ed2a3091975/1c72d/ZoomOctopus.jpg 590w,\n/static/66b00b07dbe6e8ea59bf2ed2a3091975/8608d/ZoomOctopus.jpg 638w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Generating features with SIFT: Scale-Invariant Feature Transform</h3>\n<p>We want features that correspond to \"parts\" of images, at a more holistic level than raw pixels. We want features that are not sensitive to changes in image resolution, scale, rotation, changes in illumination (eg, position of lights). The SIFT algorithm will do this. It's going to be a little complicated, so I'll start by showing you how to do it in Python with OpenCV first, then we can go into how it works. In my <a href=\"../visual-bag-of-words\">next post</a> I'll show you how to convert SIFT features to a format that can be passed directly into a Random Forest, SVM, or other machine learning classifier.</p>\n<h4>Aside: installing OpenCV 3.1.0</h4>\n<p>SIFT is a patented algorithm and isn't included in many distributions of OpenCV. Also, OpenCV's function names change drastically between versions, and old code breaks! It will save you a lot of pain if you're on the same version as me (v3.1.0) for this tutorial. And you'll need the \"nonfree\" modules to have SIFT.</p>\n<p>After struggling for some time trying to get OpenCV to compile from source, I came across <a href=\"https://rivercitylabs.org/up-and-running-with-opencv3-and-python-3-anaconda-edition/\">River City Labs's guide to installing OpenCV in Anaconda Python</a>. Here is the gist of it.</p>\n<p>To set up a conda virtual environment called <code>opencv</code>, install Anaconda then run this in the console:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">conda create -n opencv numpy scipy scikit-learn matplotlib python=2.7\nsource activate opencv\nconda install -c https://conda.binstar.org/menpo opencv3</code>\n        </deckgo-highlight-code>\n<p>Enter your virtual environment with <code>source activate opencv</code> and leave it with <code>source deactivate</code>.</p>\n<p>Another problem I ran into is that I run ipython in interactive mode all the time, and when you call <code>ipython</code>, it will ignore your conda env. So I added this to my <code>.bashrc</code>:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\"># virtualenv-aware ipython\nalias ipy=&quot;python -c &#39;import IPython; IPython.terminal.ipapp.launch_new_instance()&#39;&quot;</code>\n        </deckgo-highlight-code>\n<p>Make sure to restart <code>bash</code> so it will load the new <code>.bashrc</code>.</p>\n<p>Now you can invoke a virtualenv-aware ipython shell with the new command <code>ipy</code>. You can also launch <code>jupyter notebook</code> while within the <code>opencv</code> env without a problem, with or without this change to <code>.bashrc</code>.</p>\n<p>Phew, I hope that wasn't too bad. On to the code!</p>\n<h1>Generating SIFT Features in Python OpenCV</h1>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">%matplotlib inline\nimport cv2\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nprint &#39;OpenCV Version (should be 3.1.0, with nonfree packages installed, for this tutorial):&#39;\nprint cv2.__version__\n\n# I cropped out each stereo image into its own file.\n# You&#39;ll have to download the images to run this for yourself\nocto_front = cv2.imread(&#39;../images/Octopus_Far_Front.jpg&#39;)\nocto_offset = cv2.imread(&#39;../images/Octopus_Far_Offset.jpg&#39;)\n\ndef show_rgb_img(img):\n    &quot;&quot;&quot;Convenience function to display a typical color image&quot;&quot;&quot;\n    return plt.imshow(cv2.cvtColor(img, cv2.CV_32S))</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">OpenCV Version (should be 3.1.0, with nonfree packages installed, for this tutorial):\n3.1.0</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">show_rgb_img(octo_front);</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 278px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7583c6bd02ee9a4de30610728295f5da/4e29d/oct_output_2_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.8918918918919%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAFAklEQVR42l2Ue0xTZxjGz4hsRrCIoAsT0SmIFrQKiCgUGFLADqWgHfUGw3LrFLmJZAjFIjicqAMmyqUUi20RKFCtcrEjtNyKSlDaRbxlLnM3syxb/GPZztpnXxU12Zs85zznJN8v35fvfV6KelVOCxYs3uHi4raHwXBNdHBwFtjPZQjs7OYKKMpOYGfPIN+u5O0soOzsyD/q/0okSqLs7X1ssHdsj2XuXmZvLxaILD6r/cDyDYTf+mD4bwhBhP8mpG7jYEeQPzhh0eDz9iMxfh9279qHJMEBiIRZdHgIBxQ1R0yVlpba2YBV5efvKpvUaGvu/luj7Kf71QZ6QjdNK2ob6BxeNJ0XF07nxKynm8ok9LMHf9DfTf9Cf29+Tv9g/o1+/ujFX4+nfkZhdmkxxWQy3yW8D9plmm/Hb07C0DthGe67jeG+CdwaMqFIJMQGb3fsDt2IxC3rkBC+CUNaPUzjT2CeeArT2CNMjz6mf330AoNXR8QUgJdHvtzYbh66Po5O2RWLtk1LwEbIq89Aki0Cy9MdIV7uYC1dBG4YGyO9wxjt02O8fwQm40OiJ/Sz+79D264TU25ubvMIb56qudvULe/EuZJiS/OZKuivG9B0uhJ5e3lgs9bCw8UJK993QkocF/0qBbQKJRrLj6G5ohh3R+/TP878iasqAnRwcFhMgG5dir57DacqkcuPtjR+eRqDGh1qS4oQtGoFPFydsdlzCdhkl1zmEuTGsXG+JB/lSdtQtHMzrl++QpuNM1BI298eWVojNdeWlyEt2t9SnLQTBYLtSA72RYLfKoR4uoG9yh08Py8kb/GFMJQJUfhqFHLXoyg+BNXH8unmUxX4PCNFTDk5OTkTnktmYsJ0ZcFhZPCiLZ+ymciI8EFKsDcRE7sC1yDSxwNpMcE4GBmI9FBffBa5FnmxgSgWcFCRxqclybEQJcaKqYUUxSBABp8TNp3B24qMWI4lPYos5KxDNjcAWTEBEEUHQBCwEgfIznLjgpG66UNkhXkhj7sRudsCkBy4nK44nInGWpn4TWOX5heZ84UpSGD7Wz7298ZWpgdifJZCFMFCdsw6AlmGPb5uyIzww5H4UBRsD0Ra6BoIo0JRXXyCnjKY0dXaJ6bmz5/vQnjL5RcV5hvtvThXVmk5npOHk0eP4UhqBtIj/ZDJ9gI/iIWkqI+wl70R+9kBSOd+hMO8SEiEfAy03yCX8hSy8yox5enp+R4Bzqk/22iSX7iE8oJCy8mjR/BFQT4UNfU4nsJH3k4OuuUacvPD6OvQkV7txNkSCQ7ytyM1JgjH0z6hp4bvQ9HY8zZ6TdUyc1erBqdKyi3V5adxTnICWbuikBUfia9PVJB0GNHfOQhdjx6jA5Nol6ogyTkE8UEhKguz6XsjM1BJCdDR0dGV8Dykta2m/q4hdLdq/+1VD1q1ql5r8aFD1sLMdGu3vMeq6zFYb3brrTqN3koSZb2mvGa9UFll7WpRW7/RDP9jGnuC1np1yZsdqqRq89ANIwZ6DBadxkCSMo6RvlsY7b+DMaKXfuAObHk36qYwRnyHVElieBuT+gf0w8mfXl3K66qUnLncUqccu/iVdKShpmW0taFtSFp7aUJWpxxVNXUQL79FppFBKVUbmmsUtztaNEPyC21jsjqVkYBuKurVM1VldamvebaJw5j1tkZfOOuXETnOttYKIntb7me9rRbZJtWsX25b9x89WNZfqPB+oQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"\"\n        src=\"/static/7583c6bd02ee9a4de30610728295f5da/4e29d/oct_output_2_0.png\"\n        srcset=\"/static/7583c6bd02ee9a4de30610728295f5da/12f09/oct_output_2_0.png 148w,\n/static/7583c6bd02ee9a4de30610728295f5da/4e29d/oct_output_2_0.png 278w\"\n        sizes=\"(max-width: 278px) 100vw, 278px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">show_rgb_img(octo_offset);</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 301px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/465a1e0f4a3f9c0c9971aad8d790e9d3/fb933/oct_output_3_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAAEvElEQVR42m2Ua0zTVxjGcRal2dgYERkqbIC1w1K5tBSsEyiggrYiOh0XUS5KKQKVmwgMEm7quEyoCFSLUC22FCyuBVqhIAiCiBLnxJllOrOLs5jt87L+939WWj6YbCd5kid5T37nfc+Tc+zsbGsNlUJlUyjUYIv/j6hUx2BHR+f/rdnqVA6F4sC1s1tFs9Kozs4bPDxob+g0P/j6BJIsv63gcsIRGbYbvOBtOLojAkd4QeCHfoZsYT6KckpQXlSJuspGxO05iFUOVGKVw2rY29v3WoHp8emuHRe6TTqVEbc0d/6ZHJojH048JSf1M2RxchyZu3cnKdrJIQv2hZIz+rvkr0//IF98+4r8ZWGRfD7/G1maV2N2clqDlRSKeom3IpAZzBrsMZrujT7CpH6OnDLMYdr4EDfkvRBwfRHA8EYsh4HdW7yQnZqK7x+8xJPZF3g8/QMWZn/EzwtviJa6K6B5M2wdZiRluPV36xcHlAPQKXXk+NA0WqrLce18I7ITD8D3k48Q5LUOdNcPkJN+DPeNUxju1eLB+Dye3HuOR1PPiFfP/kSvfMAGzBOWrldIFYstVVW43NhIDt+4hUvnzqAwOQ6VhafB+NgNn6x1hvdaJ5w4xIdB3YP26i/RkJ2IOwO3l7olfvrOhLGBaSvww7CwGHZbg+T1qSQB6k8VkKP9Y+ht60Asiw5/Tw94WWAcTzeE0TdgP4uGquPxqEnZi9N8f7RXFEKn6CPu6u9C3zdm67C2tsm1tf7CYl4SHyfjosiKtFSIYnhI3kpHLNMDEXR3hHi5YR97ExIsSuFuQmb4pyiMCcBZYTzO5gmJixWnoFForMCVGze6e4uPJpqqxEIkRQSRKdsYyIpiIjWEhvTQLUjhhYAfQMPhcDZEUYE4yvZEZsRm5AuCUXWED3GMP1ErSsblplYr8L31Li5+ybHRr3MTYpEWHUqmRnJxPNwXokgm8gTbkBMdhOORAZYD6Cg+tBPi3RxkhdKQzduMJI430iKCCZ2iH1r1sG3kktwS16riisXCY8dwKIJLCtg+2OW3ETwfD8T6eSJnlz+yeD74grkOB3zdkR4eiOxoLsR7tuIEfztUUjmxcP+lJWWtFejAYoUwlR19Jq1yCJ0XOsjqotMoz81BjSVh8eEj1m6zogKQm5CIsoxM5CXEQ3zwc2TtF0AkCEfBgR2EQdkPTbfBClzNZrN9uy5eN/UrdOiQyMhzZeWozD+JM4X5aC4vQ3H8HpwRpWJiaBYTgzNW3dHPQlrfjKK0RAj3hRGyulrLyKO2kTMzC9Z2SZW/q+U3cbWt++9zZVXmhooac3tdM5Gxf4dZuHe7ubYgnxi+MWYeUBnMQ+phYlQ7ae7rUBN1JaVE69n6v0Y0RtxUjvQs8d4NZAay1HKdyaidxPA3E6Sh/zZGtVOYMtyHXHIZ9WUVGLS8otmReUzfeoCZkYe4Z5zH3Phj9F1RwtBrIJ4/eg2t0hbKOwwGw72hRtLV2XZdLamTaqWSq5ouqUrV/FWbQSnTaPquDaqlTZ2G7ks9anm7UtPWJDOoOjWqzlaFVvq1bFB2XtZ9pUUx3lAtKV3+Du3sl8JZ9u+/5V2W7njp0GW/Yrnm8tZep2XvbJHjv3wVmnQZlHe+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"\"\n        src=\"/static/465a1e0f4a3f9c0c9971aad8d790e9d3/fb933/oct_output_3_0.png\"\n        srcset=\"/static/465a1e0f4a3f9c0c9971aad8d790e9d3/12f09/oct_output_3_0.png 148w,\n/static/465a1e0f4a3f9c0c9971aad8d790e9d3/e4a3f/oct_output_3_0.png 295w,\n/static/465a1e0f4a3f9c0c9971aad8d790e9d3/fb933/oct_output_3_0.png 301w\"\n        sizes=\"(max-width: 301px) 100vw, 301px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Generating SIFT features</h3>\n<p>First, convert the images to greyscale</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">def to_gray(color_img):\n    gray = cv2.cvtColor(color_img, cv2.COLOR_BGR2GRAY)\n    return gray\n\nocto_front_gray = to_gray(octo_front)\nocto_offset_gray = to_gray(octo_offset)\n\nplt.imshow(octo_front_gray, cmap=&#39;gray&#39;);</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 278px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7f6b0dae6c3529481a427b5e67936009/4e29d/oct_output_5_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.8918918918919%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAEE0lEQVR42l1U10usVxDfSLyRq8ayN4IRzCWKLWJ5UR9UbNgrll1bULigWFEQwfL5YMeC+GAXe8GGig0VXcuuMfbdFSIIouKD/gMhOfl2MnPcvYEcmP3Od74zv5n5zW9WInlfFpaWlvFWVlYZpqamMhMTE7mxsbEcz7kZGRnxd3oazv5nMrRf0X4hsG/ox87OTuvo6AhooouLC7i7u4OXlxd4e3uDj48PJCYmgr+/PwQHB0NycjKkpKRAWloaZGZmQl5eHgsICACEESR1dXVGBNjW1nY9OTkJMzMzfy0vL7PNzU12enrKhoeHWXp6OpPJZCwpKYm1t7ezl5cX9vDwwB4fH9nT0xN7e3v78/7+HioqKmokbm5uHxDvx9nZ2VuVSgUHBwfi0dERHB4ewtnZGZSWloKTkxOEhYVBUFAQhIaGwt7eHmg0Gri9vYWbmxtQq9Xs9fWVzgUJAPCSJyYmtAqFAhBYXFlZIWDo7++nqODg4ABEg729PS+ZgtF3eiIYgbPn52dYW1sTJLa2th8R7+P09LRmbm4OmpqaxJ6eHtjf34fu7m7Izc3lPFpbW4ONjQ3nDymBpaUl6OjogM7OTri6uiIaYHV1VZBgV20Q0BYv3HR1dUFWVpZIQDs7O9DY2Aiurq4glUp52bT39PQE5JN/y8/Pp/sEzoiCqamp/0oeHBzUYmMgLi5OxK5BTk4O58vPzw+cnZ0BuQZfX18ICQmB8PBwiIyMhNTUVN7l+vp6RkkUFxcLEgsLCyvEk2IkdXV1NUlBpAZER0dzQDKSi4eHByQkJFBAiIiIgNjYWA5IlCAQoySys7MFSu57MoyopgvIkRgfH88dUSZcfwREoJQZlUuNiYqK4lokTgMDAxk1D6sUvgq7qqpKS5zgZZFKo4xI2DExMRyUQEjg9I665KKmTCkwNpJdXFwQl4LE3Nxcinifx8bGtNh2aG1tFSsrK0EQBCgoKOAAlBlmwcskOsgoe8q2sLAQ1tfXmVarBRwCQYKj9h0Cftvb26sZGRkB5FGsqakBMiyBg2ZkZMDCwgLs7u6SM2mVd5kaQvQUFRWxy8vL9y4bRg9FrCWnhoYGkbrd0tLCgeRyOdA76RLHEba3t0GpVJIzF31ZWRnU1tay6+vrd0AzM7NPiGeP2Wi2trZgcXHxn42NDR1Oi668vFxXUlKiw0A61KUOwfgTwXUobh3qVjc/P6/DzP+micFpq/2aIaJrKQt0EknUtKeZPj4+5hkZ9jTvJycn/Ayni4/f+fk5u7u7e2+KYTU3N08ih6q+vr7jgYEB5fj4uGJoaOgUiVaiI+1/x6CHZHh2hmOqGB0dVaHPb1jVDv5T/YEN/WLA+6DXIy0SurV+/xOamV5aP6MZ09zr97R+oH8q/f4z+f0LnmbYTTaceEYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"\"\n        src=\"/static/7f6b0dae6c3529481a427b5e67936009/4e29d/oct_output_5_0.png\"\n        srcset=\"/static/7f6b0dae6c3529481a427b5e67936009/12f09/oct_output_5_0.png 148w,\n/static/7f6b0dae6c3529481a427b5e67936009/4e29d/oct_output_5_0.png 278w\"\n        sizes=\"(max-width: 278px) 100vw, 278px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">def gen_sift_features(gray_img):\n    sift = cv2.xfeatures2d.SIFT_create()\n    # kp is the keypoints\n    #\n    # desc is the SIFT descriptors, they&#39;re 128-dimensional vectors\n    # that we can use for our final features\n    kp, desc = sift.detectAndCompute(gray_img, None)\n    return kp, desc\n\ndef show_sift_features(gray_img, color_img, kp):\n    return plt.imshow(cv2.drawKeypoints(gray_img, kp, color_img.copy()))\n\n# generate SIFT keypoints and descriptors\nocto_front_kp, octo_front_desc = gen_sift_features(octo_front_gray)\nocto_offset_kp, octo_offset_desc = gen_sift_features(octo_offset_gray)\n\nprint &#39;Here are what our SIFT features look like for the front-view octopus image:&#39;\nshow_sift_features(octo_front_gray, octo_front, octo_front_kp);</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">Here are what our SIFT features look like for the front-view octopus image:</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 278px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db8834ed226a7f563344a2091e605a0a/4e29d/oct_output_6_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.8918918918919%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAE8klEQVR42l2U/U+TVxTHOzI2o1icbHP4g+h0MbqNCCJWMTBKBVtb3lra0hZUKi86uyhYxAhFEAb4kiWOFmor7WPrkPdC11psKQUFq67qoCZTYZnzj1i2Z+13t4qa7CTfm/Pcl0/Ofc45l8F4bbGrVq3KjYuLkzGZTMmKFSuky5Ytk0ZFRUvJmjQ6OlqawEyQRuYZUYxXc/+ThKiU7PsyAnsvMqxbty64efNmEIW2bt2KxMREJCcnYXtKKnamZUJeKgeniIMMTiYKhSIUFYkgFouhkCugrDhE78nYjShGlIbR2NgYFQG2t7c/NlMULBbL3wODA7TdPkbfnp6iTWYzLZUpaIlcTAuFhXRT6zl6YWGRfvb0Kf3s+TN64fkCvfjy+V9zTx5DXaOuZ5BoPiC8tVar9cmUzwePZyLk9XgxfssL3+0ZfKc6iYwkFrLzOMjL2Y+9e3NgGxzBLf8sHjwK4OHDAAKBAP3yz5dwupwaBoBXVzb1mIIutxvXbuhDfcODcN26icudZqhOncZXWxKxhfyGjRs3IIObB5d9Al6HA+N2N/z++wj8EqAXf1+EzWbTMOLj45cT3nILZZ239Gvx/fftoRbtRYzeHIPhUifKjiuxhbUdG9eswdq1n0FUKAV1fQiGK1fQ3HoJDWcvYdo3Q7/44wWGh4c1DJK5Twkw3nqj79e2H1qhVB4JdZw/C9uIDZrmZrC27UDChi+wKzkNSdtSkJrCQom8HLXVaijLqnH4UDkGh3rp23OTMOkN766su3g1eOH8BeQWFYTKKg+ijGQ1i2Q0PT0Nu/bsxtfJO5CWng42hwseXwg+nwuRSIgShRItZ5voel0dVKpyDSM2NvYjwosrLVXM1Z+uwUGRLJSzjwMejySAkw02l4O0rAzsTt2JKkUxBLkFyOHug0CQC4mkEAeqjuHYCTVdrazAAblcQ1irmWRg7pXw58SiYij44hA/P3JQAGGREPliUm/FZcjh5ZI1GQ7Kq5DJzgSXy0ORJB9yWT4yv8miTzWcxI+GDs3bwq7TVAePqMqRwWaHWHvYSE1Lwk5WEvaTSEUFYrDZHKSwdkDAz0OxSAxZsYxEmkOuL0BTRys9ddeP3v5+DWPlypVxhLfeaDQGh0cGcb7tQuiMWo0zLXU4WlmFPJ4AHEEBAWYjl78f2ZwsZPG4KBQrIC4pwdHySgx1m+lHjx7DoNdrGJs2bfqQAN/Xa7XzPf0WnGw+F6o93opTtWpQBi2OV51AuUQFCykVm2scY7ZRWH6iUNtRi2KpAgW5eaisUNKz9+6AoizvWk+v7Q72DdjRVN8eqm3SoKmuHvIDpZBWlkF3WQcXgdnG7HA6HfBN+nC134iahm9Re6QCbXWnaf+DmdfAmJiYjyNvQ7e+e94+OoYBq+Vf2+hw2NpHhStrjoYbq1XhoZGBsONnR9jpcIQdDmfY7XGHr1PXw81NbWGrtTvsstn/CQQewmQyNbyN8BpFBd0eDxxOZ+im04lxzwQmJ92Ycjng9fqIvOR7Ej7S71PT07jj8cHQYcTA2AT89+7S8/Pz6O3t1TDeWEtLi9VgMMx2dnbe0el0M6aeHp9O132v22icMZvNvq6urvsURU1HpO/SP7D2Wn0G/dXZLq3R39ff5ybR/dbW1nb4DS/y4jCX/Eihr17yE4hilkrrc6LoSN8v+RH7JPJSLfnrI+f+A1dY02I9caUqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"\"\n        src=\"/static/db8834ed226a7f563344a2091e605a0a/4e29d/oct_output_6_1.png\"\n        srcset=\"/static/db8834ed226a7f563344a2091e605a0a/12f09/oct_output_6_1.png 148w,\n/static/db8834ed226a7f563344a2091e605a0a/4e29d/oct_output_6_1.png 278w\"\n        sizes=\"(max-width: 278px) 100vw, 278px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>We can also visualize how the SIFT features match up each other across the two images.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\"># create a BFMatcher object which will match up the SIFT features\nbf = cv2.BFMatcher(cv2.NORM_L2, crossCheck=True)\n\nmatches = bf.match(octo_front_desc, octo_offset_desc)\n\n# Sort the matches in the order of their distance.\nmatches = sorted(matches, key = lambda x:x.distance)\n\n# draw the top N matches\nN_MATCHES = 100\n\nmatch_img = cv2.drawMatches(\n    octo_front, octo_front_kp,\n    octo_offset, octo_offset_kp,\n    matches[:N_MATCHES], octo_offset.copy(), flags=0)\n\nplt.figure(figsize=(12,6))\nplt.imshow(match_img);</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/43c78942ddc9edd1c6fd92a8b947df1b/394f7/oct_output_8_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAADBElEQVR42i3S3U9TZwDH8XM/9xeMhM0tRg3JlqiZw6KMlkIpVK0gdCjYVo6nb4cWTilUOqxAIRDLiwMLFuspFVZPH5CSlhfLi0bgbjFZMu809pY/wJfzND9PzC4+99+LL3OsuHj2ePHR9Mnvf0z9/NMxckGtJVqDmlw1VpD6+kpiMumJSlVCystKiEFfSq41aImxuZaoay+TpotNxMPxhG21St9+c2SNYRieiYUj+ex8Cq+W1wv3RyM4X82ivuU29jM7eLv3L94dvMHO32vYSKzgIL2Dl0tbsLb5oapsRW/fJA5fv8fhf3k6MzyJH4qKRGb32ea71eQ2llM7nzt7RugvpbX0t3IjnXuwSJcWN+n6sxd0O7NLo1MLNPVwmY6GZunVi1Za9N1pqquz0KWnOZpZyX36kD/EXno7xjyOzuY9wX6MPIwWjKyA0+oaXNC3gAuEYOkZQTAcwSNRAucdw53gPPiuaagbbqFU24yKKw5cF0Zhdo7S9XgWr6S0yDg7Au81DV6cqbQXTp6/gZLfTVDV8ThVw+GcsQNGNgizbQCs7S6qGz34tdaFMo0NlzQWGHQdKCvnoTP4qakpgP6ucZExXHHltXV2nDjbUjinaUdZZTs0VU7o6gRUX/Kh0RREyDcJN+vHZb0dNRUcaqp4qPROlFaxOGtwo0TXTu+NJ/BiZUNkHv8Vz/d13oXX5StYrV4033DjptmDm1YfzJZuDA2GQR4lEJuYwr0/B+Hv7kUjp1RZ3PAHgui+E8IfVoFywgBWRElkpJm5t+JwH8b6Bz7ZbR55bGhITkam5dh4WPZ2uWRvt1NOPOiXl2YH5ehUSJ6bHpdv9/rk6Mx9+c3BhmJTTkmRj/HEE+xnd2PMlpTJv87tIZfMFhITcewuZvFSeo49soWn0Xn8s/oc67EknNfNaLewENrsuGVqBddigd3MwqZwtHK0x+GFu80hMuJE1CLNLfAkluRXE6nOHFlzrCXT/HJcEjYWMo59suUKB4YFZVrn/7wKl8KhEL7OzDA2hV9R/QUbYsN0OpkD5QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"\"\n        src=\"/static/43c78942ddc9edd1c6fd92a8b947df1b/fcda8/oct_output_8_0.png\"\n        srcset=\"/static/43c78942ddc9edd1c6fd92a8b947df1b/12f09/oct_output_8_0.png 148w,\n/static/43c78942ddc9edd1c6fd92a8b947df1b/e4a3f/oct_output_8_0.png 295w,\n/static/43c78942ddc9edd1c6fd92a8b947df1b/fcda8/oct_output_8_0.png 590w,\n/static/43c78942ddc9edd1c6fd92a8b947df1b/394f7/oct_output_8_0.png 707w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Most of the matched points correspond to each other between the two images, despite perspective shift and some scaling.</p>\n<h1>What is SIFT doing?</h1>\n<p>I will give a very simplified, intuitive, visual description of the SIFT algorithm here.</p>\n<p>For a nice overview of SIFT with pictures, see <a href=\"https://gilscvblog.com/2013/08/18/a-short-introduction-to-descriptors/\">https://gilscvblog.com/2013/08/18/a-short-introduction-to-descriptors/</a></p>\n<p>For an in-depth explanation, see <a href=\"http://docs.opencv.org/3.1.0/da/df5/tutorial_py_sift_intro.html\">http://docs.opencv.org/3.1.0/da/df5/tutorial_py_sift_intro.html</a></p>\n<p>For the deepest depth, read the original academic paper <a href=\"https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf\">https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf</a></p>\n<h2>1) Difference of Gaussians</h2>\n<p>If you've messed with Photoshop or GIMP you know what a Gaussian blur is. You set the \"size\" of the blur in pixels -- this number is also called <code>sigma</code>. Then you get a uniformly blurred image.</p>\n<p>The Difference of Gaussians (DoG) is easy to do in Photoshop/GIMP. First greyscale the image. Then duplicate the layer a few times and do a Gaussian Blur on each one with a different sigma value. Finally, set the layer blending mode to \"Difference\" for all the layers, and look at any 2 layers.</p>\n<p>\"Difference\" simply subtracts the pixel intensities of corresponding pixels: <code>difference[x][y] = layer1[x][y] - layer2[x][y]</code>.</p>\n<p>I did this with my stereo octopus image. Here are a few DoG results:</p>\n<style>.gauss {height: 400px;}</style>\n<h4>sigmas: 10, 5</h4>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/0dc3622ecb95fb3d544238b774728a14/8608d/octopus_gauss_10_5.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAb/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGfAB//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAE/IV//2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAFhABAQEAAAAAAAAAAAAAAAAAABEB/9oACAEBAAE/EIiK3Vf/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"octopus gauss 10 5\" title=\"\" src=\"/static/0dc3622ecb95fb3d544238b774728a14/1c72d/octopus_gauss_10_5.jpg\" srcset=\"/static/0dc3622ecb95fb3d544238b774728a14/a80bd/octopus_gauss_10_5.jpg 148w,\n/static/0dc3622ecb95fb3d544238b774728a14/1c91a/octopus_gauss_10_5.jpg 295w,\n/static/0dc3622ecb95fb3d544238b774728a14/1c72d/octopus_gauss_10_5.jpg 590w,\n/static/0dc3622ecb95fb3d544238b774728a14/8608d/octopus_gauss_10_5.jpg 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h4>sigmas: 25, 5</h4>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c9e03b453933c288cf77c69fcbc23ab7/8608d/octopus_gauss_25_5.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwkBR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAgIDAAAAAAAAAAAAAAAAABEBMUFhcf/aAAgBAQABPyHslZFGxjGf/9oADAMBAAIAAwAAABAzD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQACAQUAAAAAAAAAAAAAAAEAESExQWFxgf/aAAgBAQABPxBpcj7KphSx1XNzoRW4QVYn/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"octopus gauss 25 5\" title=\"\" src=\"/static/c9e03b453933c288cf77c69fcbc23ab7/1c72d/octopus_gauss_25_5.jpg\" srcset=\"/static/c9e03b453933c288cf77c69fcbc23ab7/a80bd/octopus_gauss_25_5.jpg 148w,\n/static/c9e03b453933c288cf77c69fcbc23ab7/1c91a/octopus_gauss_25_5.jpg 295w,\n/static/c9e03b453933c288cf77c69fcbc23ab7/1c72d/octopus_gauss_25_5.jpg 590w,\n/static/c9e03b453933c288cf77c69fcbc23ab7/8608d/octopus_gauss_25_5.jpg 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h4>sigmas: 25, 10</h4>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/37e07983e779dafb8ce32b4e1b21de74/8608d/octopus_gauss_25_10.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGCAD//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAABBQEAAAAAAAAAAAAAAAAAASAhMUFx/9oACAEBAAE/IeqVpDP/2gAMAwEAAgADAAAAEMDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEBAAMAAAAAAAAAAAAAAQAhEUFRYf/aAAgBAQABPxB10YxiuLyt34S+yFv/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"octopus gauss 25 10\" title=\"\" src=\"/static/37e07983e779dafb8ce32b4e1b21de74/1c72d/octopus_gauss_25_10.jpg\" srcset=\"/static/37e07983e779dafb8ce32b4e1b21de74/a80bd/octopus_gauss_25_10.jpg 148w,\n/static/37e07983e779dafb8ce32b4e1b21de74/1c91a/octopus_gauss_25_10.jpg 295w,\n/static/37e07983e779dafb8ce32b4e1b21de74/1c72d/octopus_gauss_25_10.jpg 590w,\n/static/37e07983e779dafb8ce32b4e1b21de74/8608d/octopus_gauss_25_10.jpg 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h4>sigmas: 100, 25</h4>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/292f3f2ff89b46374b2cc39e1efcd0d4/8608d/octopus_gauss_100_25.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeIjSkj/xAAWEAEBAQAAAAAAAAAAAAAAAAAAESH/2gAIAQEAAQUCxjFVX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAQEBAQEAAAAAAAAAAAAAABEAYRBB/9oACAEBAAE/IRZHiN8KV//aAAwDAQACAAMAAAAQ4w//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhUTFhcf/aAAgBAQABPxC0WpTO4hdnq+Itv5LHILtjZkHqaqPJ/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"octopus gauss 100 25\" title=\"\" src=\"/static/292f3f2ff89b46374b2cc39e1efcd0d4/1c72d/octopus_gauss_100_25.jpg\" srcset=\"/static/292f3f2ff89b46374b2cc39e1efcd0d4/a80bd/octopus_gauss_100_25.jpg 148w,\n/static/292f3f2ff89b46374b2cc39e1efcd0d4/1c91a/octopus_gauss_100_25.jpg 295w,\n/static/292f3f2ff89b46374b2cc39e1efcd0d4/1c72d/octopus_gauss_100_25.jpg 590w,\n/static/292f3f2ff89b46374b2cc39e1efcd0d4/8608d/octopus_gauss_100_25.jpg 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>By doing Difference of Gaussians at different scales, we can see features that appear small and large in the image. In contrast if we only looked at the 100, 25 DoG, we would lose a lot of detail. If we looked only at the 25, 5 DoG, we would miss out on larger-scale features.</p>\n<p>Immediately you can see how edges are suddenly very apparent. DoG functions as an edge detector. However, <strong>we do NOT want to use edges</strong> as feature-rich areas for SIFT. We want our SIFT features to be at intrinsically interesting blobs, not edge blobs. We can start again from the original image and use an edge detector to determine edges (I used Sobel, canonical SIFT uses its own):</p>\n<h4>Edge detector output</h4>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/73a5d62023d17e7b22c0d288026ba893/8608d/octopus_edge_detect.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAckhjID/xAAYEAADAQEAAAAAAAAAAAAAAAAAARICE//aAAgBAQABBQKBYZzZbLY9n//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAQEBAAAAAAAAAAAAAAAAABABMf/aAAgBAQAGPwIy0w//xAAcEAACAgIDAAAAAAAAAAAAAAABEQAhMWFBUXH/2gAIAQEAAT8hcgs2IwixCwrYEqGPe4ROgeNQhVcT/9oADAMBAAIAAwAAABADz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQADAAIDAAAAAAAAAAAAAAEAESFBUWFxsf/aAAgBAQABPxAbLyFlHt4mqN01b4qZaxq0SZgBEsfUqHIa20wwEotuveT/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"octopus edge detect\" title=\"\" src=\"/static/73a5d62023d17e7b22c0d288026ba893/1c72d/octopus_edge_detect.jpg\" srcset=\"/static/73a5d62023d17e7b22c0d288026ba893/a80bd/octopus_edge_detect.jpg 148w,\n/static/73a5d62023d17e7b22c0d288026ba893/1c91a/octopus_edge_detect.jpg 295w,\n/static/73a5d62023d17e7b22c0d288026ba893/1c72d/octopus_edge_detect.jpg 590w,\n/static/73a5d62023d17e7b22c0d288026ba893/8608d/octopus_edge_detect.jpg 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h4>Remove edges from DoG (sigma 25, 10) -- \"Artist's Rendering\"</h4>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/379c45eda320a646f79705faaff7ed8f/8608d/octopus_edge_removed_DoG10_5.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwkoB/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRAAAwADAAAAAAAAAAAAAAAAAAERQVFh/9oACAEBAAE/IZtkmWRdKUp//9oADAMBAAIAAwAAABDjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQACAgMBAAAAAAAAAAAAAAEAESFBMVFhgf/aAAgBAQABPxBDyP2FGILOLeiS/RcXsJfRP//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"octopus edge removed DoG10 5\" title=\"\" src=\"/static/379c45eda320a646f79705faaff7ed8f/1c72d/octopus_edge_removed_DoG10_5.jpg\" srcset=\"/static/379c45eda320a646f79705faaff7ed8f/a80bd/octopus_edge_removed_DoG10_5.jpg 148w,\n/static/379c45eda320a646f79705faaff7ed8f/1c91a/octopus_edge_removed_DoG10_5.jpg 295w,\n/static/379c45eda320a646f79705faaff7ed8f/1c72d/octopus_edge_removed_DoG10_5.jpg 590w,\n/static/379c45eda320a646f79705faaff7ed8f/8608d/octopus_edge_removed_DoG10_5.jpg 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h2>Keypoint detection</h2>\n<p>Now with the edges removed, we will go over different image scales and find at which scale an interesting blob is best represented. In image classification literature, the scale of a feature is called the \"octave\". So for each interesting blob we save its octave, x, and y coordinates as a keypoint.</p>\n<h2>Rotation normalization</h2>\n<p>We want to be able to match features regardless of their orientation, so that we can match a part of an eye or tentacle no matter how the eye or tentacle is rotated. To solve this problem, SIFT features are assigned an \"orientation\" based on the pixel intensities of the surrounding area.</p>\n<p>Essentially, you can imagine that we have some rule about orientation -- for example, we could make a rule that the direction pointing from the center of the feature to brightest region of neighboring pixels is selected as a feature's \"orientation\" direction. Then we turn the feature so that \"orientation\" (the brightest region) is pointing upwards. Now all similar features will \"line up\" with each other, even if they are rotated differently in the images they come from:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/7753ebb1abec0113cf2c779b15f43e3a/41be6/orientation_normalization.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAC4jAAAuIwF4pT92AAADDUlEQVR42nWUy09TQRTGywKslbQqBhoRSCCwIayhCxO3hBUbEhIWiMF/wKAhSozoFsMjbIWmYHRjgqj4IgiGimgplFKkl0cLbWlLHwi9be9t7/2ce9pUMTDJ6U1nzvzOOfOdGRXYkCSJTJZlyMpXmQxuAy4LUk4zUtsWILCBtDKXFgExAeaM04ZK+UmlUhAEgUwURaTTaSDqhbS3ysAcpH0HHNOvEHOvsXkf5JAbEvM7E9jd3Y3q6moYDAbU19fDaDRml2Xs+fbxtH8Q+tJrMI0/p1kKeMYgYGtrK1QqFXQ6HfLz89Hb20uLprExXCkqgl6vxwWNBjU1NTg6OkQ0ImJ9PcIqk08HdnR0ELCsrAxXS0vxuPcRmw1jvP8JtJeKUFVZiYKCAvLp6rrDQEDPg5/weXmCJJMCnX8O2NLSQllUVFTQpoc99wHrC2B5Eq03b+OiTgu1Wo3CwkL09fXRRr8/BJ7nCaQcwQmg1WrF7Ows2cTEBDiOy5Vgs9lQXl6Ozs5OeDwemuP5OAKBIBKJBAlKp/0vUIkQi8UoYjweJ2P9w5wkUj4SiZD6gUAgJwjPx6hUBUrtls2UgCaTCSUlJairqyNh2traMlGlNPWnxWJBe3s7GhoMbJOIgwMBKys+RKNhJlKMZZlm4CQFJ+Dw8DCdnVJaXl4empqaCBiNRtHY2AgNU7i2tpZ8jMYRTE2FMfLMgWDAlSv5hMoDgwPkrFhxcTG67t4D1j4jtfAShus3WOtcpsyV9aqqalZ6CGkJcHA87M44djwC/AcilU3AocEhcj5/Tg2N+jwr7xaw9R3gZvDm/Semsg5arTYLrATn3KBsVtZ5zC3GMG0+htefuTmqWIqHw/ULr2cm8WH+I97OvcO8zYyk9PdqNTc30/mOjo6SCNR7goQlexzmJR5buwL7n1XZdbiLRb8F34I/MB9YgP3QgS/er7D6l3NAt9tNSmceksxGUZSxupGAhUHtziQ4V5LeC9WRcIzt6A6coU1w4U3s/fZiI8xBCfT/yLxI2VsuK+0mkynZidlr+AfSJ8zvUnwH6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"orientation normalization\" title=\"\" src=\"/static/7753ebb1abec0113cf2c779b15f43e3a/fcda8/orientation_normalization.png\" srcset=\"/static/7753ebb1abec0113cf2c779b15f43e3a/12f09/orientation_normalization.png 148w,\n/static/7753ebb1abec0113cf2c779b15f43e3a/e4a3f/orientation_normalization.png 295w,\n/static/7753ebb1abec0113cf2c779b15f43e3a/fcda8/orientation_normalization.png 590w,\n/static/7753ebb1abec0113cf2c779b15f43e3a/41be6/orientation_normalization.png 638w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h2>Keypoint descriptor generation</h2>\n<p>We finally have our keypoints: x, y, and octave locations for all our points of interest, plus orientation. The keypoints are scale-invariant and rotation-invariant. We could probably take raw intensity values from each keypoint region at this point and come up with a half-decent match on similar features. However, SIFT takes it a step further by instead generating descriptors for each keypoint not with raw intensity values, but by computing the <strong>gradient</strong> of each pixel (a gradient is a vector of partial derivatives, so for a pixel its gradient describes how intensity changes as X and Y change). Then it bins the gradients into 8 directions (like N, NE, E, SE, S, SW, W, NW) and builds an 8-bin histogram.</p>\n<p>One advantage of this process, called histogram of oriented gradients, is that it is very robust against changes in illumination conditions across images.</p>\n<p><a href=\"https://gilscvblog.com/2013/08/18/a-short-introduction-to-descriptors/\">Gil's CV Blog</a> has some great explanatory illustrations of this how SIFT generates its descriptors:</p>\n<h3>Compute the gradient for each pixel at a given octave:</h3>\n<img src=\"https://gilscvblog.files.wordpress.com/2013/08/figure4.jpg\" class=\"gil\">\n*via Gil's CV Blog*\n<h3>Divide the feature region into 16 square subregions. Bin each region into an 8-direction histogram</h3>\n<img src=\"https://gilscvblog.files.wordpress.com/2013/08/figure5.jpg\" class=\"gil\">\n*via Gil's CV Blog*\n<h3>Concatenate the 16 histograms together to get the final 128-element SIFT descriptor!</h3>\n<img src=\"https://gilscvblog.files.wordpress.com/2013/08/figure6.jpg\" class=\"gil\">\n*via Gil's CV Blog*\n<h4>Here's a real-life descriptor from our octopus</h4>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">octo_front_desc[0]</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">array([   1.,    0.,    0.,    0.,    0.,    0.,    0.,    1.,   65.,\n          6.,    1.,    0.,    0.,    0.,    2.,   24.,  195.,    1.,\n          0.,    0.,    0.,    0.,    0.,  123.,   72.,    0.,    0.,\n         12.,   14.,    2.,    2.,   37.,    2.,    2.,    0.,    0.,\n          0.,    0.,    1.,    1.,  141.,   12.,    0.,    0.,    0.,\n          0.,    2.,   27.,  195.,   34.,    2.,    4.,    3.,    1.,\n          0.,   88.,   54.,   10.,    4.,   38.,   48.,    6.,    1.,\n         21.,    3.,    1.,    1.,    0.,    0.,    0.,    1.,    5.,\n        139.,   19.,    4.,    1.,    0.,    0.,    2.,   12.,  195.,\n         73.,    3.,    3.,    1.,    1.,    0.,    2.,   52.,   17.,\n          5.,   24.,   15.,    7.,    6.,    3.,    1.,    1.,    2.,\n          1.,    0.,    0.,    2.,    2.,   81.,   17.,    4.,    2.,\n          0.,    0.,    4.,    6.,  195.,   81.,    0.,    0.,    0.,\n          0.,    0.,    1.,   59.,   18.,    0.,    3.,   10.,    3.,\n          1.,    1.], dtype=float32)</code>\n        </deckgo-highlight-code>\n<p>Let's inspect a keypoint object that we generated earlier.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">print len(octo_front_kp), &#39;keypoints in the list&#39;\nprint octo_front_kp[0]</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">416 keypoints in the list\n&lt;KeyPoint 0x7f7dd3ad47e0&gt;</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">def explain_keypoint(kp):\n    print &#39;angle\\n&#39;, kp.angle\n    print &#39;\\nclass_id\\n&#39;, kp.class_id\n    print &#39;\\noctave (image scale where feature is strongest)\\n&#39;, kp.octave\n    print &#39;\\npt (x,y)\\n&#39;, kp.pt\n    print &#39;\\nresponse\\n&#39;, kp.response\n    print &#39;\\nsize\\n&#39;, kp.size\n\nprint &#39;this is an example of a single SIFT keypoint:\\n* * *&#39;\nexplain_keypoint(octo_front_kp[0])</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">this is an example of a single SIFT keypoint:\n* * *\nangle\n79.6034545898\n\nclass_id\n-1\n\noctave (image scale where feature is strongest)\n12714495\n\npt (x,y)\n(145.86351013183594, 10.573795318603516)\n\nresponse\n0.0161379538476\n\nsize\n2.14202713966</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">print &#39;SIFT descriptors are vectors of shape&#39;, octo_front_desc[0].shape\nprint &#39;they look like this:&#39;\nocto_front_desc[0]</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\">SIFT descriptors are vectors of shape (128,)\nthey look like this:\n\n\n\n\n\narray([   1.,    0.,    0.,    0.,    0.,    0.,    0.,    1.,   65.,\n          6.,    1.,    0.,    0.,    0.,    2.,   24.,  195.,    1.,\n          0.,    0.,    0.,    0.,    0.,  123.,   72.,    0.,    0.,\n         12.,   14.,    2.,    2.,   37.,    2.,    2.,    0.,    0.,\n          0.,    0.,    1.,    1.,  141.,   12.,    0.,    0.,    0.,\n          0.,    2.,   27.,  195.,   34.,    2.,    4.,    3.,    1.,\n          0.,   88.,   54.,   10.,    4.,   38.,   48.,    6.,    1.,\n         21.,    3.,    1.,    1.,    0.,    0.,    0.,    1.,    5.,\n        139.,   19.,    4.,    1.,    0.,    0.,    2.,   12.,  195.,\n         73.,    3.,    3.,    1.,    1.,    0.,    2.,   52.,   17.,\n          5.,   24.,   15.,    7.,    6.,    3.,    1.,    1.,    2.,\n          1.,    0.,    0.,    2.,    2.,   81.,   17.,    4.,    2.,\n          0.,    0.,    4.,    6.,  195.,   81.,    0.,    0.,    0.,\n          0.,    0.,    1.,   59.,   18.,    0.,    3.,   10.,    3.,\n          1.,    1.], dtype=float32)</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"vscode\"  >\n          <code slot=\"code\"># visualized another way:\nplt.imshow(octo_front_desc[0].reshape(16,8), interpolation=&#39;none&#39;);</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 142px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fdf0cdfc0fc57aab780b9a465e56150e/0d76a/oct_output_15_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 176.76056338028167%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAjCAYAAACU9ioYAAAACXBIWXMAAAsSAAALEgHS3X78AAAGQElEQVR42nVWC2xTZRQ+t/e23WBbyzYeIog8ZSOdg22yhY0lPBQGBMgg4HgNgfFQwiPAcDBGS6F0L9iAwXi0YzCQaYhEHoqQMTQYHkGDmBgS4yMxmKgJiSHGXJrj99//r4wKTb6e9vb+3z3/d75z/hLJl2a9OwsGUuL4PDImZxPl5RCNzXkas7vEvJxnf5+UYxgTR7tchW7Fl9UNb8OJiluJyplok0m0gdVn4P2YuLlL3CjuixjGOh42bM50yZc+22GlOXBzWBt5msm1F4QBJs2Pm32A9wUQv+3Afc0RZ1wLezyrFWEHG1Y892WImJmKvwDhUSa9Xi3aDlQ9B3go7QYeRuwGc1raQUmYVVZmF3FI6eZwTm0b9/A0gXAfa7aAIotFlBDZkZ8nTD0aWbjiBM8oXisJc4niEQYsJa3lCBGPolkgrGEbbVMLtwJbgAqFbaxp4nqlhdu3+kawLw40pEnC9PR0S8MxRUWhOe8t4X6DNpriyZq2XS1qAA4Dx4AWoFpl6rOwMrghUndhPZeuXaA0ZKmho/NaqBs01EvOmFYVDa/K6DxwF7gP/KCIRcGCUsMRDyPGWGg4XmlIZc2WhgnLasLJ+66x4/UDplVFm09t9xDQBsAB9CFQp6q8C9jJxquXIgmZNzizwDs9xofLjhM1iuqZMgPvCzWU15Vt4EO7sR5VVj4sy8qyMpw7NjfsnVfEaf39IGxnm1atNHxRlf0yS+f5iMPVwZ7MCknIHWRp2Nmkh/gBccmbW0D4DRt6Q5eMKlXc9nwf2hnGVho2Z5GVYf04R+juQuJxngaTUh+xHh+WBCJTrRbAYi2gtulVcQe/UtYZyQh+ywWlfkmYQdQdwfO2ZrRUI2HPoBMm5TPbenwkF2p7lHV2q21COy2qbyUX3doXeYf3c1HDUtUpWbJTMvJXhCfMCXKvtMsmJf/EWtxpua0+nzENhm3euME07ismt8gcD9F2WZr2K7keGVFxnwtKVIZ4kOxlL3r5Cjyffw8aXkQvC6vsBdHPTNNxvTzCMAHIL+M6SLUaVWnZy55oL1OW9GFcdk24+9TrbLz0gWktsO2X20w9w9T/EpMHBh+NByUelN1iZQgdbZ9GHPE3UJTKqA8zhIajYCD4UNzsM+Wsiw6ACjX/yhW2qqr7lKYNmId74cNS5cMy6cO1xSPDbZvzOHt4IwjvsE0XLVYrK6v5ZOfYRJGiftypuqUdtrmIDMtjfBiCD3+FD4uOmFaD6+dYjDE5DJ43FwOqn6+A8DYIVeulxFNfEf158UevTiYevwm9HHrM9swzMkNbnSLd+d+Eedp2AodBeByEah46ccog9F1k1w8FkVpua6OZyI85bmabzEIPqq15Vads7/JZ6OmHhj5oqMaXyzXAOq0Gv1UZylp8ilPn3jKNeb+x3v+snCxaJ+L3wFXgAnBcTaADLIdJPTKsRYbLY3y49UYIo48p7xE0/B1bvaQ65BcWmsJvwI/AZTXG2hR5IwjrQLhKEXbv1ds69QZ7j+nZ51hLOWmSdhKEIoMaNaXb2Tq4LFvVK03rZcdQLQhrumRIzol460U0r1nqU2FK7/lUJavUPIzOxKgP1fii3dBw51MNe6anJ4jY3x8IpXVc5MSCz0F4kzW9VWVQowaDT5FH7VOnNGxChs1Pz+VC7rA0HN7ZHMrnrzml5AEI/2DN+FgtqI2pcpWKDUqC8LO2cTgcQxHip+WPPLJmSh6PqW4yB1/9jhNzD0sSm7+LsWMntvBmjaqyGl9xSBKh9zK73tyAcs5uLTdz+Sanztxj6abpVV08tzVmegvsAGEXH0ZPvT6rmo4O2n+Tk+fe/7v7mIem0bNFFOcJaUHE6idErYhnEUWvi2u7xGEm4j92e4AzMlZOk4TNdyxCaoQP78FvE//CTX+yzX6Kdb0C2APUA58AncARoBYIAjvYZgtGnM4AZ2ZGfVhVZRPBXbyxIHmJb11K/rH5CamBMnfPtQuSEiavcLtLFyUlFSNuQlzxrsu1tDQpadZyl2v+YpdrxjK3e/FCt3vKmqFDp7xMMS9hn9cAXfzXEfUCBqo4SLY9pUnZre/JgCiocElf+t9r9mydJq12UmEVbijEIvGfZwCiOHMmgaxdlxDfxX/KQtw3xCm/izWk/QtT4qBYUUB5UAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"\"\n        src=\"/static/fdf0cdfc0fc57aab780b9a465e56150e/0d76a/oct_output_15_0.png\"\n        srcset=\"/static/fdf0cdfc0fc57aab780b9a465e56150e/0d76a/oct_output_15_0.png 142w\"\n        sizes=\"(max-width: 142px) 100vw, 142px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"May 06, 2016","slug":"how-to-sift-opencv-vbow-part-1","title":"VBoW Pt 1 - Image Classification in Python with SIFT Features","splashImage":null}}},"pageContext":{"id":"33540d1f-7a84-5da0-92f2-3da111a00a1f","frontmatter__slug":"how-to-sift-opencv-vbow-part-1","__params":{"frontmatter__slug":"how-to-sift-opencv-vbow-part-1"}}},"staticQueryHashes":[],"slicesMap":{}}